

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>UFM Configuration &mdash; xCAT 2.12 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="xCAT 2.12 documentation" href="../../../index.html"/>
        <link rel="up" title="InfiniBand (Mellanox)" href="index.html"/>
        <link rel="next" title="Firmware Updates" href="firmware_updates.html"/>
        <link rel="prev" title="IB Switch Configuration" href="switch_configuration.html"/> 

  
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../../index.html" class="icon icon-home"> xCAT
          

          
          </a>

          
            
            
              <div class="version">
                2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/install-guides/index.html">Install Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../guides/admin-guides/index.html">Admin Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Advanced Topics</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../chain/index.html">Chain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cluster_maintenance/index.html">Cluster Maintenance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../confluent/index.html">Confluent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../docker/index.html">Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../domain_name_resolution/index.html">Domain Name Resolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../gpu/index.html">GPUs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hamn/index.html">High Availability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../hierarchy/index.html">Hierarchical Clusters / Large Cluster Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../kit/index.html">Software Kits</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../mixed_cluster/index.html">Mixed Cluster</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Networks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ethernet_switches/index.html">Ethernet Switches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../switchdiscover/index.html">Switch Discover</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html">InfiniBand (Mellanox)</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="mlnxofed_ib_install_v2.html">Mellanox OFED Installation Script</a></li>
<li class="toctree-l4"><a class="reference internal" href="network_configuration.html">IB Network Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="switch_configuration.html">IB Switch Configuration</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="">UFM Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="firmware_updates.html">Firmware Updates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ipv6/index.html">IPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../edgecore_switches/index.html">Edgecore Switches</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../ports/xcat_ports.html">Port Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../probe/index.html">xCAT probe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../raid/index.html">RAID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../restapi/index.html">Rest API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../security/index.html">Security</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../softlayer/index.html">SoftLayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../switches/index.html">Switch Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sysclone/index.html">System Clone (sysclone)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../zones/index.html">Zones</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../developers/index.html">Developers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../help.html">Need Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../security/index.html">Security Notices</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">xCAT</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../../index.html">Advanced Topics</a> &raquo;</li>
      
          <li><a href="../index.html">Networks</a> &raquo;</li>
      
          <li><a href="index.html">InfiniBand (Mellanox)</a> &raquo;</li>
      
    <li>UFM Configuration</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../../_sources/advanced/networks/infiniband/ufm_configuration.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ufm-configuration">
<h1>UFM Configuration<a class="headerlink" href="#ufm-configuration" title="Permalink to this headline">¶</a></h1>
<p>UFM server are just regular Linux boxes with UFM installed. xCAT can help install and configure the UFM servers. The XCAT mn can send remote command to UFM through xdsh. It can also collect SNMP traps and syslogs from the UFM servers.</p>
<div class="section" id="setup-xdsh-to-ufm-and-backup">
<h2>Setup xdsh to UFM and backup<a class="headerlink" href="#setup-xdsh-to-ufm-and-backup" title="Permalink to this headline">¶</a></h2>
<p>Assume we have two hosts with UFM installed, called host1 and host2. First define the two hosts in the xCAT cluster. Usually the network that the UFM hosts are in a different than the compute nodes, make sure to assign correct servicenode and xcatmaster in the noderes table. And also make sure to assign correct os and arch values in the nodetype table for the UFM hosts. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>mkdef -t node -o host1,host2 groups=ufm,all os=sles11.1 arch=x86_64 servicenode=10.0.0.1 xcatmaster=10.0.0.1
</pre></div>
</div>
<p>Then exchange the SSH key so that it can run xdsh.</p>
<div class="highlight-python"><div class="highlight"><pre>xdsh host1,host2 -K
</pre></div>
</div>
<p>Now we can run xdsh on the UFM hosts.</p>
<div class="highlight-python"><div class="highlight"><pre>xdsh ufm date
</pre></div>
</div>
</div>
<div class="section" id="consolidate-syslogs">
<h2>Consolidate syslogs<a class="headerlink" href="#consolidate-syslogs" title="Permalink to this headline">¶</a></h2>
<p>Run the following command to make the UFM hosts to send the syslogs to the xCAT mn:</p>
<div class="highlight-python"><div class="highlight"><pre>updatenode ufm -P syslog
</pre></div>
</div>
<p>To test, run the following commands on the UFM hosts and see if the xCAT MN receives the new messages in /var/log/messages</p>
<div class="highlight-python"><div class="highlight"><pre>logger xCAT &quot;This is a test&quot;
</pre></div>
</div>
</div>
<div class="section" id="send-snmp-traps-to-xcat-management-node">
<h2>Send SNMP traps to xCAT Management Node<a class="headerlink" href="#send-snmp-traps-to-xcat-management-node" title="Permalink to this headline">¶</a></h2>
<p>You need to have the Advanced License for UFM in order to send SNMP traps.</p>
<ol class="arabic">
<li><p class="first">Copy the mib file to <code class="docutils literal"><span class="pre">/usr/share/snmp/mibs</span></code> directory on the mn.</p>
<div class="highlight-python"><div class="highlight"><pre>scp ufmhost:/opt/ufm/files/conf/vol_ufm3_0.mib /usr/share/snmp/mibs
</pre></div>
</div>
</li>
</ol>
<p>Where ufmhost is the host where UFM is installed.</p>
<ol class="arabic" start="2">
<li><p class="first">On the UFM host, open the /opt/ufm/conf/gv.cfg configuration file. Under the [Notifications] line, set</p>
<div class="highlight-python"><div class="highlight"><pre>snmp_listeners = &lt;IP Address 1&gt;[:&lt;port 1&gt;][,&lt;IP Address 2&gt;[:&lt;port 2&gt;].]
</pre></div>
</div>
</li>
</ol>
<p>The default port is 162. For example:</p>
<div class="highlight-python"><div class="highlight"><pre>ssh ufmhost
vi /opt/ufm/conf/gv.cfg

....
[Notifications]
snmp_listeners = 10.0.0.1
</pre></div>
</div>
<p>Where 10.0.0.1 is the the ip address of the management node.</p>
<ol class="arabic" start="3">
<li><p class="first">On the UFM host, restart the ufmd</p>
<div class="highlight-python"><div class="highlight"><pre>service ufmd restart
</pre></div>
</div>
</li>
<li><p class="first">From UFM GUI, click on the &#8220;Config&#8221; tab; bring up the &#8220;Event Management&#8221; Policy Table. Then select the SNMP check boxes for the events you are interested in to enable the system to send an SNMP traps for these events. Click &#8220;OK&#8221;.</p>
</li>
<li><p class="first">Make sure snmptrapd is up and running on mn and all monitoring servers.</p>
</li>
</ol>
<p>It should have the &#8216;-m ALL&#8217; flag.</p>
<div class="highlight-python"><div class="highlight"><pre>ps -ef |grep snmptrapd
root 31866 1 0 08:44 ? 00:00:00 /usr/sbin/snmptrapd -m ALL
</pre></div>
</div>
<p>If it is not running, then run the following commands:</p>
<div class="highlight-python"><div class="highlight"><pre>monadd snmpmon
monstart snmpmon
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="firmware_updates.html" class="btn btn-neutral float-right" title="Firmware Updates" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="switch_configuration.html" class="btn btn-neutral" title="IB Switch Configuration" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, IBM Corporation.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'2.12',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>